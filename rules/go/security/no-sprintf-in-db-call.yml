id: go-security-no-sprintf-in-db-call
language: go
severity: error
message: "Database query uses fmt.Sprintf, which is a SQL injection vulnerability. Use parameterized queries with placeholders ($1, $2, etc.) instead."
metadata:
  author: hackafterdark
  tags: security, injection, go
  description: "Detects the use of fmt.Sprintf in database calls, which is a common SQL injection vulnerability."
rule:
  any:
    - pattern: $DB.Exec($$$, fmt.Sprintf($$$))
    - pattern: $DB.ExecContext($$$, fmt.Sprintf($$$))
    - pattern: $DB.Query($$$, fmt.Sprintf($$$))
    - pattern: $DB.QueryRow($$$, fmt.Sprintf($$$))
    - pattern: $DB.QueryRowContext($$$, fmt.Sprintf($$$))